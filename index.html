<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#8b5cf6">
    <meta name="description" content="Complete personal finance management with AI coaching">
    
    <!-- PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="FinanceOS">
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- Icons -->
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="manifest.json">
    
    <title>FinanceOS - Personal Finance Dashboard</title>
    
    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/date-fns/1.30.1/index.min.js"></script>
    
    <!-- Styles -->
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/components.css">
    <link rel="stylesheet" href="styles/dashboard.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="main-nav glass">
        <div class="nav-container">
            <div class="nav-brand">
                <svg width="48" height="48" viewBox="0 0 512 512" class="nav-logo">
                    <rect width="512" height="512" rx="115" fill="url(#backgroundGradient)"/>
                    <circle cx="256" cy="256" r="140" fill="url(#centralGradient)"/>
                    <text x="256" y="280" text-anchor="middle" font-size="120" font-weight="bold" fill="white">$</text>
                    <defs>
                        <linearGradient id="backgroundGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" stop-color="#6366f1"/>
                            <stop offset="50%" stop-color="#8b5cf6"/>
                            <stop offset="100%" stop-color="#3b82f6"/>
                        </linearGradient>
                        <linearGradient id="centralGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" stop-color="#10b981" stop-opacity="0.9"/>
                            <stop offset="100%" stop-color="#059669" stop-opacity="0.9"/>
                        </linearGradient>
                    </defs>
                </svg>
                <span class="nav-title">FinanceOS</span>
            </div>
            
            <div class="nav-menu" id="navMenu">
                <a href="index.html" class="nav-link active" data-page="dashboard">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                        <rect x="9" y="9" width="6" height="6"/>
                        <path d="m9 1 0 8"/>
                        <path d="m15 1 0 8"/>
                        <path d="m1 9 8 0"/>
                        <path d="m1 15 8 0"/>
                    </svg>
                    Dashboard
                    <div class="nav-indicator"></div>
                </a>
                <a href="budget.html" class="nav-link" data-page="budget">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <line x1="12" y1="1" x2="12" y2="23"/>
                        <path d="m17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                    </svg>
                    Budget
                    <div class="nav-indicator"></div>
                </a>
                <a href="goals.html" class="nav-link" data-page="goals">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                        <circle cx="12" cy="12" r="3"/>
                    </svg>
                    Goals
                    <div class="nav-indicator"></div>
                </a>
                <a href="csv-upload.html" class="nav-link" data-page="upload">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="7,10 12,15 17,10"/>
                        <line x1="12" y1="15" x2="12" y2="3"/>
                    </svg>
                    Upload
                    <div class="nav-indicator"></div>
                </a>
            </div>
            
            <div class="nav-actions">
                <button class="privacy-toggle" id="privacyToggle" title="Toggle Privacy Mode">
                    <svg class="eye-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                        <circle cx="12" cy="12" r="3"/>
                    </svg>
                </button>
                <button class="hamburger" id="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Financial Health Alert -->
        <div class="alert-banner critical-alert">
            <div class="alert-content">
                <div class="alert-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/>
                        <path d="M12 9v4"/>
                        <path d="M12 17h.01"/>
                    </svg>
                </div>
                <div class="alert-text">
                    <h3>Critical Financial Alert</h3>
                    <p>Monthly budget deficit of $3,607 detected. Emergency fund critically low at $0.17. Immediate action required.</p>
                </div>
                <button class="alert-action">Fix Now</button>
            </div>
        </div>

        <!-- Dashboard Header -->
        <header class="dashboard-header">
            <div class="header-content">
                <div class="welcome-section">
                    <h1 class="dashboard-title">Financial Overview</h1>
                    <p class="dashboard-subtitle">Your complete financial picture at a glance</p>
                </div>
                <div class="quick-stats glass-premium">
                    <div class="stat-item">
                        <span class="stat-label">Net Worth</span>
                        <span class="stat-value privacy-sensitive">$313,956</span>
                        <span class="stat-change positive">+2.3%</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Monthly Cash Flow</span>
                        <span class="stat-value privacy-sensitive negative">-$3,607</span>
                        <span class="stat-change negative">-15.7%</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Savings Rate</span>
                        <span class="stat-value">0%</span>
                        <span class="stat-change neutral">Target: 20%</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Account Overview -->
        <section class="account-overview">
            <h2 class="section-title">Account Overview</h2>
            <div class="accounts-grid">
                <!-- Checking Accounts -->
                <div class="account-card checking">
                    <div class="account-header">
                        <div class="account-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <rect x="1" y="4" width="22" height="16" rx="2" ry="2"/>
                                <line x1="1" y1="10" x2="23" y2="10"/>
                            </svg>
                        </div>
                        <div class="account-info">
                            <h3>My Spending</h3>
                            <span class="account-type">Transaction Account</span>
                        </div>
                        <div class="account-status warning">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/>
                            </svg>
                        </div>
                    </div>
                    <div class="account-balance">
                        <span class="balance-amount privacy-sensitive">$25.92</span>
                        <span class="available-amount">$25.92 Available</span>
                    </div>
                </div>

                <div class="account-card savings">
                    <div class="account-header">
                        <div class="account-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 6v6l4 2"/>
                            </svg>
                        </div>
                        <div class="account-info">
                            <h3>My Savings</h3>
                            <span class="account-type">Savings Account</span>
                        </div>
                        <div class="account-status critical">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <circle cx="12" cy="12" r="10"/>
                                <line x1="15" y1="9" x2="9" y2="15"/>
                                <line x1="9" y1="9" x2="15" y2="15"/>
                            </svg>
                        </div>
                    </div>
                    <div class="account-balance">
                        <span class="balance-amount privacy-sensitive">$0.17</span>
                        <span class="available-amount">$0.17 Available</span>
                    </div>
                </div>

                <!-- Joint Accounts -->
                <div class="account-card joint-savings">
                    <div class="account-header">
                        <div class="account-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                                <circle cx="12" cy="7" r="4"/>
                            </svg>
                        </div>
                        <div class="account-info">
                            <h3>House Kitty</h3>
                            <span class="account-type">Joint Savings</span>
                        </div>
                        <div class="account-status good">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                                <polyline points="22,4 12,14.01 9,11.01"/>
                            </svg>
                        </div>
                    </div>
                    <div class="account-balance">
                        <span class="balance-amount privacy-sensitive">$65,357.00</span>
                        <span class="available-amount">$65,357.00 Available</span>
                    </div>
                </div>

                <div class="account-card bills">
                    <div class="account-header">
                        <div class="account-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                <polyline points="14,2 14,8 20,8"/>
                                <line x1="16" y1="13" x2="8" y2="13"/>
                                <line x1="16" y1="17" x2="8" y2="17"/>
                                <polyline points="10,9 9,9 8,9"/>
                            </svg>
                        </div>
                        <div class="account-info">
                            <h3>Mortgage & Billing</h3>
                            <span class="account-type">Bill Payment Account</span>
                        </div>
                        <div class="account-status good">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                                <polyline points="22,4 12,14.01 9,11.01"/>
                            </svg>
                        </div>
                    </div>
                    <div class="account-balance">
                        <span class="balance-amount privacy-sensitive">$126.35</span>
                        <span class="available-amount">$126.35 Available</span>
                    </div>
                </div>

                <!-- Credit and Loans -->
                <div class="account-card credit-card">
                    <div class="account-header">
                        <div class="account-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <rect x="1" y="4" width="22" height="16" rx="2" ry="2"/>
                                <line x1="1" y1="10" x2="23" y2="10"/>
                            </svg>
                        </div>
                        <div class="account-info">
                            <h3>Low Rate Visa</h3>
                            <span class="account-type">Credit Card</span>
                        </div>
                        <div class="account-status warning">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/>
                            </svg>
                        </div>
                    </div>
                    <div class="account-balance">
                        <span class="balance-amount privacy-sensitive negative">-$3,251.30</span>
                        <span class="available-amount">$6,748.70 Available</span>
                    </div>
                </div>

                <div class="account-card investment">
                    <div class="account-header">
                        <div class="account-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <polyline points="22,12 18,12 15,21 9,3 6,12 2,12"/>
                            </svg>
                        </div>
                        <div class="account-info">
                            <h3>ANZ KiwiSaver</h3>
                            <span class="account-type">Retirement Fund</span>
                        </div>
                        <div class="account-status good">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                                <polyline points="22,4 12,14.01 9,11.01"/>
                            </svg>
                        </div>
                    </div>
                    <div class="account-balance">
                        <span class="balance-amount privacy-sensitive">$48,733.44</span>
                        <span class="available-amount">3% Contribution Rate</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Financial Summary -->
        <section class="financial-summary">
            <div class="summary-grid">
                <div class="summary-card assets">
                    <div class="summary-header">
                        <h3>Total Assets</h3>
                        <div class="summary-icon positive">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <line x1="12" y1="19" x2="12" y2="5"/>
                                <polyline points="5,12 12,5 19,12"/>
                            </svg>
                        </div>
                    </div>
                    <div class="summary-amount privacy-sensitive">$114,242.88</div>
                    <div class="summary-breakdown">
                        <div class="breakdown-item">
                            <span>Cash & Savings</span>
                            <span class="privacy-sensitive">$65,509.44</span>
                        </div>
                        <div class="breakdown-item">
                            <span>Investments</span>
                            <span class="privacy-sensitive">$48,733.44</span>
                        </div>
                    </div>
                </div>

                <div class="summary-card liabilities">
                    <div class="summary-header">
                        <h3>Total Liabilities</h3>
                        <div class="summary-icon negative">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <line x1="12" y1="5" x2="12" y2="19"/>
                                <polyline points="19,12 12,19 5,12"/>
                            </svg>
                        </div>
                    </div>
                    <div class="summary-amount privacy-sensitive">$274,851.32</div>
                    <div class="summary-breakdown">
                        <div class="breakdown-item">
                            <span>Home Loans</span>
                            <span class="privacy-sensitive">$271,600.02</span>
                        </div>
                        <div class="breakdown-item">
                            <span>Credit Cards</span>
                            <span class="privacy-sensitive">$3,251.30</span>
                        </div>
                    </div>
                </div>

                <div class="summary-card net-worth">
                    <div class="summary-header">
                        <h3>Net Worth</h3>
                        <div class="summary-icon neutral">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                            </svg>
                        </div>
                    </div>
                    <div class="summary-amount privacy-sensitive negative">-$160,608.44</div>
                    <div class="summary-note">Mortgage impact on net worth</div>
                </div>
            </div>
        </section>

        <!-- Quick Actions -->
        <section class="quick-actions">
            <h2 class="section-title">Quick Actions</h2>
            <div class="actions-grid">
                <a href="csv-upload.html" class="action-card upload">
                    <div class="action-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="7,10 12,15 17,10"/>
                            <line x1="12" y1="15" x2="12" y2="3"/>
                        </svg>
                    </div>
                    <h3>Upload Bank Statements</h3>
                    <p>Import CSV files from your bank</p>
                </a>

                <a href="budget.html" class="action-card budget">
                    <div class="action-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                            <line x1="16" y1="2" x2="16" y2="6"/>
                            <line x1="8" y1="2" x2="8" y2="6"/>
                            <line x1="3" y1="10" x2="21" y2="10"/>
                        </svg>
                    </div>
                    <h3>Review Budget</h3>
                    <p>Track spending vs budget</p>
                </a>

                <a href="goals.html" class="action-card goals">
                    <div class="action-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <circle cx="12" cy="12" r="10"/>
                            <polygon points="16.24,7.76 14.12,14.12 7.76,16.24 9.88,9.88 16.24,7.76"/>
                        </svg>
                    </div>
                    <h3>Manage Goals</h3>
                    <p>Track savings and debt payoff</p>
                </a>

                <button class="action-card ai-coach" onclick="openAICoach()">
                    <div class="action-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/>
                        </svg>
                    </div>
                    <h3>AI Financial Coach</h3>
                    <p>Get personalized advice</p>
                </button>
            </div>
        </section>

        <!-- Recent Activity Preview -->
        <section class="recent-activity">
            <div class="section-header">
                <h2 class="section-title">Recent Activity</h2>
                <button class="view-all-btn">View All</button>
            </div>
            <div class="activity-list">
                <div class="activity-item">
                    <div class="activity-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <rect x="1" y="4" width="22" height="16" rx="2" ry="2"/>
                            <line x1="1" y1="10" x2="23" y2="10"/>
                        </svg>
                    </div>
                    <div class="activity-details">
                        <div class="activity-description">COUNTDOWN CHRISTCHURCH</div>
                        <div class="activity-meta">Today • Groceries</div>
                    </div>
                    <div class="activity-amount privacy-sensitive negative">-$127.50</div>
                </div>

                <div class="activity-item">
                    <div class="activity-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M12 1v22m5-18H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                        </svg>
                    </div>
                    <div class="activity-details">
                        <div class="activity-description">Pathway Engineering Ltd</div>
                        <div class="activity-meta">Dec 15 • Salary</div>
                    </div>
                    <div class="activity-amount privacy-sensitive positive">+$6,304.00</div>
                </div>

                <div class="activity-item">
                    <div class="activity-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                            <line x1="16" y1="2" x2="16" y2="6"/>
                            <line x1="8" y1="2" x2="8" y2="6"/>
                            <line x1="3" y1="10" x2="21" y2="10"/>
                        </svg>
                    </div>
                    <div class="activity-details">
                        <div class="activity-description">ANZ Mortgage Payment</div>
                        <div class="activity-meta">Dec 14 • Housing</div>
                    </div>
                    <div class="activity-amount privacy-sensitive negative">-$2,070.00</div>
                </div>
            </div>
        </section>
    </main>

    <!-- AI Coach Modal -->
    <div class="ai-coach-modal" id="aiCoachModal">
        <div class="modal-backdrop"></div>
        <div class="modal-content glass-premium">
            <div class="modal-header">
                <h3>AI Financial Coach</h3>
                <button class="modal-close" onclick="closeAICoach()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            
            <div class="chat-container" id="chatContainer">
                <div class="chat-message ai-message">
                    <div class="message-avatar">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <circle cx="12" cy="12" r="5"/>
                            <path d="M12 1v6M12 17v6M4.22 4.22l4.24 4.24M15.54 15.54l4.24 4.24M1 12h6M17 12h6M4.22 19.78l4.24-4.24M15.54 8.46l4.24-4.24"/>
                        </svg>
                    </div>
                    <div class="message-content">
                        <p>Hi! I'm your AI Financial Coach. I've noticed some critical issues with your finances:</p>
                        <ul>
                            <li>❌ Monthly deficit of $3,607 - you're spending more than you earn</li>
                            <li>🚨 Emergency fund at only $0.17 - extremely risky</li>
                            <li>💳 Credit card debt of $3,251 accumulating interest</li>
                        </ul>
                        <p>Ask me anything about your spending, budget, or how to fix these issues!</p>
                    </div>
                </div>
            </div>
            
            <div class="chat-input-area">
                <div class="quick-questions">
                    <button class="quick-question" onclick="askQuestion('How can I fix my budget deficit?')">
                        How can I fix my budget deficit?
                    </button>
                    <button class="quick-question" onclick="askQuestion('What should I cut from my spending?')">
                        What should I cut from my spending?
                    </button>
                    <button class="quick-question" onclick="askQuestion('How long to pay off credit card?')">
                        How long to pay off credit card?
                    </button>
                </div>
                
                <div class="chat-input">
                    <input type="text" id="chatInput" placeholder="Ask about your finances..." onkeypress="handleChatKeyPress(event)">
                    <button onclick="sendChatMessage()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <line x1="22" y1="2" x2="11" y2="13"/>
                            <polygon points="22,2 15,22 11,13 2,9 22,2"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- PWA Install Prompt -->
    <div class="install-prompt" id="installPrompt">
        <div class="install-content glass">
            <div class="install-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                    <polyline points="7,10 12,15 17,10"/>
                    <line x1="12" y1="15" x2="12" y2="3"/>
                </svg>
            </div>
            <div class="install-text">
                <h4>Install FinanceOS</h4>
                <p>Add to your home screen for the best experience</p>
            </div>
            <div class="install-actions">
                <button class="install-btn" onclick="installPWA()">Install</button>
                <button class="dismiss-btn" onclick="dismissInstall()">Later</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/app.js"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/ai-coach.js"></script>
    <script src="js/privacy.js"></script>
</body>
</html>